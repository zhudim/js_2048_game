const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.cells=t,this.restart()}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>0!==t),a=[];for(let e=0;e<s.length;e++)s[e]===s[e+1]?(a.push(2*s[e]),this.score+=2*s[e],e++,t=!0):a.push(s[e]);for(;a.length<4;)a.push(0);this.board[e].toString()!==a.toString()&&(this.board[e]=a,t=!0)}t&&this.addRandomTile(),this.checkGameOver()}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>0!==t).reverse(),a=[],r=0;for(;r<s.length;)s[r]===s[r+1]?(a.push(2*s[r]),this.score+=2*s[r],r+=2,t=!0):(a.push(s[r]),r++);for(;a.length<4;)a.push(0);a.reverse(),this.board[e].toString()!==a.toString()&&(this.board[e]=a,t=!0)}t&&this.addRandomTile(),this.checkGameOver()}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);let a=[],r=0;for(;r<s.length;)s[r]===s[r+1]?(a.push(2*s[r]),this.score+=2*s[r],r+=2):(a.push(s[r]),r++);for(;a.length<4;)a.push(0);for(let s=0;s<4;s++)this.board[s][e]!==a[s]&&(t=!0),this.board[s][e]=a[s]}t&&this.addRandomTile(),this.checkGameOver()}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);let a=[],r=s.length-1;for(;r>=0;)s[r]===s[r-1]?(a.unshift(2*s[r]),this.score+=2*s[r],r-=2,t=!0):(a.unshift(s[r]),r--);for(;a.length<4;)a.unshift(0);for(let s=0;s<4;s++)this.board[s][e]!==a[s]&&(t=!0),this.board[s][e]=a[s]}t&&this.addRandomTile(),this.checkGameOver()}checkGameOver(){this.board.some(t=>t.includes(2048))?this.status="win":this.canMove()||(this.status="lose")}canMove(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!0;return!1}displayGameStatus(t){let e=document.querySelector(".message-win"),s=document.querySelector(".message-lose");e.classList.add("hidden"),s.classList.add("hidden"),"win"===t?e.classList.remove("hidden"):"lose"===t?s.classList.remove("hidden"):"playing"===t&&(e.classList.add("hidden"),s.classList.add("hidden"))}getScore(){return this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.board=this.cells.map(t=>[...t]),this.score=0,this.status="idle"}addRandomTile(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,a)=>{0===e&&t.push({rowIndex:s,colIndex:a})})}),t.length>0){let e=Math.floor(Math.random()*t.length),{rowIndex:s,colIndex:a}=t[e];this.board[s][a]=.9>Math.random()?2:4;let r=document.querySelector(`[data-position="${s}-${a}"]`);requestAnimationFrame(()=>{r.classList.add("field-cell--new"),setTimeout(()=>{r.classList.remove("field-cell--new")},300)})}}},e=document.querySelector(".game-score"),s=document.getElementById("startButton"),a=document.querySelector(".message-start"),r=document.querySelector(".message-win"),i=document.querySelector(".message-lose");function o(){t.getState().forEach((t,e)=>{t.forEach((t,s)=>{let a=document.querySelector(`[data-position="${e}-${s}"]`);a.textContent=0!==t?t:"",a.className="field-cell",0!==t&&a.classList.add(`field-cell--${t}`)})})}function d(){e.textContent=t.getScore()}function l(){let e=t.getStatus();"win"===e?(r.classList.remove("hidden"),i.classList.add("hidden"),a.classList.add("hidden")):"lose"===e?(i.classList.remove("hidden"),r.classList.add("hidden"),a.classList.add("hidden")):("idle"===e?a.classList.remove("hidden"):a.classList.add("hidden"),r.classList.add("hidden"),i.classList.add("hidden"))}s.addEventListener("click",()=>{s.classList.contains("start")?(t.start(),o(),l(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"):(t.restart(),o(),d(),l(),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start")}),window.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}o(),d(),l()});
//# sourceMappingURL=index.ca34b350.js.map
